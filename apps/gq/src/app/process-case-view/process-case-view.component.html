<div
  class="flex h-full flex-col"
  *ngIf="
    !(customerLoading$ | ngrxPush) && !(quotationLoading$ | ngrxPush);
    else loading
  "
>
  <schaeffler-subheader
    *ngIf="quotation$ | ngrxPush as quotation"
    [subheaderTitle]="
      quotation.caseName ? quotation.caseName : (quotation.gqId | gqQuotation)
    "
    [breadcrumbs]="breadcrumbs$ | ngrxPush"
  >
    <ng-container subheaderTitleContent>
      <div class="flex flex-row">
        <span *ngIf="quotation.sapId" class="ml-4 text-low-emphasis">{{
          quotation.sapId | sapQuotation
        }}</span>
        <gq-header-content
          [quotation]="quotation"
          (updateCaseName)="updateCaseName($event)"
          (updateCurrency)="updateCurrency($event)"
        ></gq-header-content>
      </div>
    </ng-container>
    <ng-container subheaderInlineContent>
      <schaeffler-share-button></schaeffler-share-button>
    </ng-container>
    <ng-container subheaderBlockContent>
      <gq-customer-header [customer]="quotation.customer"> </gq-customer-header>
    </ng-container>
  </schaeffler-subheader>
  <mat-card
    class="m-4 mt-5 flex h-full"
    *ngIf="
      !(quotation$ | ngrxPush).calculationInProgress &&
        !(quotation$ | ngrxPush).sapCallInProgress;
      else taskInProgress
    "
  >
    <gq-quotation-details-table
      *ngIf="!(updateLoading$ | ngrxPush); else updateLoading"
      [quotation]="quotation$ | ngrxPush"
    ></gq-quotation-details-table>
    <ng-template #updateLoading>
      <schaeffler-loading-spinner></schaeffler-loading-spinner>
    </ng-template>
  </mat-card>
  <ng-template #taskInProgress>
    <gq-calculation-in-progress
      [amountDetails]="(quotation$ | ngrxPush).quotationDetails.length"
      [isSapRefreshInProgress]="(quotation$ | ngrxPush).sapCallInProgress"
    >
    </gq-calculation-in-progress>
  </ng-template>
</div>
<ng-template #loading>
  <schaeffler-loading-spinner></schaeffler-loading-spinner>
</ng-template>
