<div
  oncontextmenu="return false;"
  class="flex w-full flex-row justify-between"
  role="presentation"
  (click)="onSortRequested($event)"
>
  @if (!(editMode || value)) {
    <div ref="eLabel" class="ag-header-cell-label" role="presentation">
      <span
        ref="eText"
        class="ag-header-cell-text w-full truncate"
        [matTooltip]="params.displayName"
        [matTooltipDisabled]="!text.isTruncated"
        isTextTruncated
        #text="isTextTruncated"
      >
        {{ params.displayName }}
      </span>
      @if (sort || showEditIcon || params.tooltipText) {
        <div class="flex items-center justify-end">
          @if (sort) {
            <div class="flex w-4 items-center justify-center">
              @if (sort === 'asc') {
                <span class="ag-icon ag-icon-asc"></span>
              }
              @if (sort === 'desc') {
                <span class="ag-icon ag-icon-desc"></span>
              }
            </div>
          }
          @if (sort && (showEditIcon || params.tooltipText)) {
            <div class="w-2"></div>
          }
          @if (
            (quotationStatus$ | ngrxPush) &&
            (showEditIcon || params.tooltipText)
          ) {
            <div class="flex w-4 items-start justify-start pb-[2px]">
              @if (showEditIcon) {
                <mat-icon (click)="enableEditMode($event)" class="edit-icon">
                  mode_edit
                </mat-icon>
              }
              @if (!showEditIcon && params.tooltipText) {
                <gq-info-icon
                  [displaySmall]="true"
                  [text]="params?.tooltipText"
                ></gq-info-icon>
              }
            </div>
          }
        </div>
      }
    </div>
  }
  @if (!(editMode || value)) {
    <span
      ref="eMenu"
      class="ag-header-icon ag-header-cell-menu-button pl-2"
      aria-hidden="true"
    >
      <span
        class="ag-icon ag-icon-menu"
        #menuButton
        (click)="onMenuClicked($event)"
      ></span>
    </span>
  }
</div>
@if (editMode || value) {
  <div>
    @if (!isPriceSourceColumn) {
      <mat-form-field appearance="outline" class="w-full">
        <input
          #inputField
          matInput
          type="text"
          [placeholder]="params.displayName"
          (keydown.enter)="submitValue($event)"
          (blur)="disableEditMode()"
          class="!text-on-surface !text-body-small !font-semibold"
          [formControl]="editFormControl"
          autocomplete="off"
          step="1"
        />
        <span matSuffix class="!pb-[6px]">%&nbsp;</span>
      </mat-form-field>
    } @else {
      <mat-form-field
        appearance="outline"
        class="w-full"
        *transloco="
          let t;
          read: 'shared.quotationDetailsTable.headers.priceSource'
        "
      >
        <input
          #inputField
          matInput
          type="text"
          [value]="t(getSelectedPriceSourceTranslationKey())"
          [readonly]="true"
          class="!text-on-surface !text-body-small !font-semibold"
        />
        <span (click)="switchPriceSource()" matSuffix
          ><mat-icon class="">unfold_more</mat-icon>
        </span>
      </mat-form-field>
    }
  </div>
}
