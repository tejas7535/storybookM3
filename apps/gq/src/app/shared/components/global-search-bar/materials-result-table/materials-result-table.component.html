<ng-container
  *transloco="let t; read: 'searchBarAdvanced.materialsResultsTable'"
>
  <div class="flex flex-col h-full pt-6 gap-4">
    <div class="flex flex-row items-center">
      <span class="text-on-surface-variant text-title-small pr-6"
        >{{ t('searchCriteriaLabel') }}
      </span>
      <mat-radio-group
        (change)="radioButtonChanged()"
        [(ngModel)]="criteriaSelectedValue"
        class="flex flex-row gap-6 px-2"
      >
        @for (criteria of criteriaSelections; track criteria) {
          <mat-radio-button
            [value]="criteria"
            class="text-title-small"
            labelPosition="after"
            disableRipple
            >{{ t(criteria) }}</mat-radio-button
          >
        }
      </mat-radio-group>
    </div>
    <div class="h-full">
      @if (loading) {
        <ng-container [ngTemplateOutlet]="loadingTemplate"></ng-container>
      } @else {
        @if (!materialsResults) {
          <ng-container [ngTemplateOutlet]="noInitialResults"></ng-container>
        } @else {
          @if (materialsResults?.length === 0) {
            <ng-container [ngTemplateOutlet]="noResults"></ng-container>
          } @else {
            <ng-container [ngTemplateOutlet]="tableResults"></ng-container>
          }
        }
      }
    </div>
  </div>

  <ng-template #noResults>
    <gq-no-data class="h-full" [title]="t('noResultsTitle')"> </gq-no-data>
  </ng-template>

  <ng-template #noInitialResults>
    <gq-no-data
      class="h-full"
      [title]="t('noInitialResultsTitle')"
      [subTitle]="t('noInitialResultsSubTitle')"
    >
    </gq-no-data>
  </ng-template>

  <ng-template #tableResults>
    <!--
    Dynamically set spinner's class and dialog size based on result count by assigning a panelClass to MatDialogConfig. 
    Modify panel classes and sizes in gq module's styles.scss. 
    Applies to '#loadingTemplate' as well.
    -->
    <ag-grid-angular
      oncontextmenu="return false;"
      class="ag-theme-material h-full overflow-hidden rounded-xl border border-border"
      [ngClass]="{
        'material-results-table-with-pagination': materialsResults?.length > 4,
      }"
      [defaultColDef]="defaultColDef"
      [columnDefs]="columnDefs$ | ngrxPush"
      [components]="components"
      [localeText]="localeText$ | ngrxPush"
      [context]="gridContext"
      (gridReady)="onGridReady($event)"
      (columnResized)="onColumnChange($event)"
      (columnMoved)="onColumnChange($event)"
      (sortChanged)="onColumnChange($event)"
      (filterChanged)="onFilterChanged($event)"
      (rowDoubleClicked)="onRowDoubleClicked($event)"
      (columnPinned)="onColumnChange($event)"
      [rowSelection]="rowSelection"
      [rowData]="materialsResults"
      [postSortRows]="searchbarColUtilsService.postSortRows"
      [gridOptions]="
        materialsResults?.length > 8
          ? gridOptions
          : gridOptionsWithoutPagination
      "
      columnMenu="legacy"
    >
    </ag-grid-angular>
  </ng-template>

  <ng-template #loadingTemplate>
    <schaeffler-loading-spinner
      [ngClass]="{
        'material-results-table-with-pagination': materialsResults?.length > 4,
      }"
    ></schaeffler-loading-spinner>
  </ng-template>
</ng-container>
