<div
  class="flex h-full flex-col"
  *transloco="let t; prefix: 'shared.uploadDialog'"
>
  <gq-dialog-header
    [title]="modalData.dialogTitle ?? t('title')"
    (closeDialog)="closeDialog()"
  ></gq-dialog-header>
  @if (modalData.dialogSubtitle) {
    <span class="text-body-medium text-on-surface pt-5">{{
      modalData.dialogSubtitle
    }}</span>
  }
  @if (modalData.showWarning) {
    <gq-info-banner
      class="pb-4"
      [isWarning]="true"
      [infoText]="modalData.warningMessage"
    ></gq-info-banner>
  }

  @if (!(attachmentsUploading$ | ngrxPush)) {
    <div class="flex-grow mt-4">
      <div
        class="border-2 h-24 border-dashed border-border rounded-lg w-full flex justify-center items-center font-bold cursor-pointer"
        id="dragSquare"
        dragAndDrop
        (filesDropped)="handleDroppedFiles($event)"
      >
        <div class="flex flex-col items-center">
          <div class="flex flex-row items-center">
            <div
              class="flex flex-row items-center group hover:border-b hover:border-primary"
            >
              <input
                type="file"
                (change)="handleFileInput($event)"
                multiple
                id="fileInput"
                enctype="multipart/form-data"
                class="hidden"
              />
              <label for="fileInput" class="flex items-center">
                <mat-icon class="mr-2 !text-icon-link">add</mat-icon>
                <p class="text-primary font-medium mr-1 flex-grow">
                  {{ t('uploadButton') }}
                </p>
              </label>
            </div>
            <p class="text-on-surface-variant font-medium">
              {{ t('dialogOptionInfo') }}
            </p>
          </div>
          <p
            class="text-on-surface opacity-[0.38] text-[12px] mt-3"
            [innerHTML]="t('dialogInfo')"
          ></p>
        </div>
      </div>
    </div>
    <div class="overflow-y-auto max-h-72">
      @if (filesToUpload()?.length > 0) {
        <div class="mt-4">
          @for (fileToDisplay of filesToUpload(); track fileToDisplay) {
            <div class="flex flex-row items-center">
              @if (
                fileToDisplay.exists ||
                fileToDisplay.sizeExceeded ||
                fileToDisplay.unsupportedFileType
              ) {
                <mat-icon
                  class="text-error mr-2 !w-4 !h-4 !text-[16px]"
                  [matTooltip]="
                    fileToDisplay.exists
                      ? t('fileExitsTooltip')
                      : fileToDisplay.unsupportedFileType
                        ? t('fileTypeNotSupportedTooltip')
                        : t('fileSizeExceedsTooltip')
                  "
                >
                  close
                </mat-icon>
              } @else {
                <mat-icon
                  class="text-approval-status-green mr-2 !w-4 !h-4 !text-[16px]"
                >
                  check_circle_outline
                </mat-icon>
              }
              <span class="text-on-surface text-body-medium">{{
                fileToDisplay?.file?.name
              }}</span>
              <div class="ml-auto text-approval-status-grey mt-1">
                <div class="group inline-block">
                  <mat-icon
                    class="!w-5 !h-5 !icon-5 hover:text-approval-status-green relative text-approval-status-grey"
                  >
                    <span class="group-hover:opacity-0"> delete </span>
                    <mat-icon
                      class="absolute inset-0 flex items-center justify-center font-bold opacity-0 group-hover:opacity-100 !w-5 !h-5 !icon-5"
                      (click)="removeFile(fileToDisplay)"
                    >
                      delete_forever
                    </mat-icon>
                  </mat-icon>
                </div>
              </div>
            </div>
          }
        </div>
      }
      @if (modalData.templateRef) {
        <div class="mt-4">
          <ng-container
            *ngTemplateOutlet="modalData.templateRef"
          ></ng-container>
        </div>
      }
    </div>
    <div class="mt-11 flex justify-end gap-4 flex-row">
      <button mat-button (click)="closeDialog()">
        {{ t('cancelButton') }}
      </button>
      <button mat-flat-button (click)="upload()" [disabled]="uploadDisabled()">
        {{ this.modalData.uploadButtonCaption ?? t('uploadButton') }}
      </button>
    </div>
  } @else {
    <div class="py-3">
      <schaeffler-loading-spinner
        class="h-full"
        [relative]="true"
      ></schaeffler-loading-spinner>
    </div>
  }
</div>
