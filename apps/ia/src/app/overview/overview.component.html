<div *transloco="let t; read: 'overview'">
  <div
    class="bg-surface-legacy grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 grid-rows-4 md:grid-rows-2 xl:grid-rows-1 gap-4"
  >
    <div class="w-full p-4 shadow">
      <div class="flex-1">
        <div class="flex h-full flex-col">
          <h5>{{ t('fluctuationRate') }}</h5>
          <div
            class="divide-border grid grid-cols-2 divide-x divide-solid pb-4"
          >
            <div class="mb-4 pl-4">
              <ia-kpi
                [type]="'leavers'"
                [title]="(benchmarkFluctuationKpi$ | ngrxPush)?.name"
                [value]="(benchmarkFluctuationKpi$ | ngrxPush)?.fluctuationRate"
                [showTeamMemberDialog]="false"
                [isLoading]="isBenchmarkFluctuationKpiLoading$ | ngrxPush"
                [viewRights]="isUserAllowedToViewBenchmarkRates$ | ngrxPush"
              ></ia-kpi>
            </div>
            <div class="mb-4 pl-4">
              <ia-kpi
                [type]="'leavers'"
                [title]="(dimensionFluctuationKpi$ | ngrxPush)?.name"
                [value]="(dimensionFluctuationKpi$ | ngrxPush)?.fluctuationRate"
                [employees]="externalExitEmployees$ | ngrxPush"
                [employeesLoading]="exitEmployeesLoading$ | ngrxPush"
                [employeeListDialogMetaHeadings]="
                  totalFluctuationListDialogMetaHeadings$ | ngrxPush
                "
                [employeesCount]="
                  (dimensionFluctuationKpi$ | ngrxPush)?.realTotalLeaversCount
                "
                [showTooltip]="true"
                [isLoading]="isDimensionFluctuationKpiLoading$ | ngrxPush"
                [excludedColumns]="['from', 'to']"
                [viewRights]="isUserAllowedToViewDimensionRates$ | ngrxPush"
                (openTeamMembers)="triggerLoadExitEmployees()"
              ></ia-kpi>
            </div>
          </div>
          <div class="grow">
            <ia-line-chart
              [config]="fluctuationRatesChartConfig | ngrxPush"
              [isDataLoading]="isFluctuationChartLoading$ | ngrxPush"
              [title]="t('fluctuationChartTitle')"
              [series]="fluctuationChartData$ | ngrxPush"
              [benchmarkSeries]="benchmarkfluctuationChartData$ | ngrxPush"
            ></ia-line-chart>
          </div>
        </div>
      </div>
    </div>
    <div class="w-full p-4 shadow">
      <div class="flex-1">
        <div class="flex h-full flex-col">
          <h5>{{ t('unforcedFluctuationRate') }}</h5>
          <div
            class="divide-border grid grid-cols-2 divide-x divide-solid pb-4"
          >
            <div class="mb-4 pl-4">
              <ia-kpi
                [type]="'leavers'"
                [title]="(benchmarkFluctuationKpi$ | ngrxPush)?.name"
                [value]="
                  (benchmarkFluctuationKpi$ | ngrxPush)?.unforcedFluctuationRate
                "
                [showTeamMemberDialog]="false"
                [isLoading]="isBenchmarkFluctuationKpiLoading$ | ngrxPush"
                [viewRights]="isUserAllowedToViewBenchmarkRates$ | ngrxPush"
              ></ia-kpi>
            </div>
            <div class="mb-4 pl-4">
              <ia-kpi
                [type]="'leavers'"
                [title]="(dimensionFluctuationKpi$ | ngrxPush)?.name"
                [value]="
                  (dimensionFluctuationKpi$ | ngrxPush)?.unforcedFluctuationRate
                "
                [employees]="externalUnforcedExitEmployees$ | ngrxPush"
                [employeesLoading]="exitEmployeesLoading$ | ngrxPush"
                [employeeListDialogMetaHeadings]="
                  unforcedFluctuationListDialogMetaHeadings$ | ngrxPush
                "
                [employeesCount]="
                  (dimensionFluctuationKpi$ | ngrxPush)
                    ?.realUnforcedLeaversCount
                "
                [showTooltip]="true"
                [isLoading]="isDimensionFluctuationKpiLoading$ | ngrxPush"
                [excludedColumns]="['reasonForLeaving', 'from', 'to']"
                [viewRights]="isUserAllowedToViewDimensionRates$ | ngrxPush"
                (openTeamMembers)="triggerLoadExitEmployees()"
              ></ia-kpi>
            </div>
          </div>
          <div class="grow">
            <ia-line-chart
              [config]="unforcedFluctuationRatesChartConfig | ngrxPush"
              [isDataLoading]="isFluctuationChartLoading$ | ngrxPush"
              [title]="t('unforcedFluctuationChartTitle')"
              [series]="unforcedFluctuationChartData$ | ngrxPush"
              [benchmarkSeries]="
                benchmarkUnforcedFluctuationChartData$ | ngrxPush
              "
            ></ia-line-chart>
          </div>
        </div>
      </div>
    </div>
    <div class="w-full p-4 shadow">
      <div class="flex-1">
        <ia-entries-exits
          [data]="chartData$ | ngrxPush"
          [isDataLoading]="isLoadingDoughnutsConfig$ | ngrxPush"
          [entriesCount]="entriesCount$ | ngrxPush"
          [exitsCount]="exitsCount$ | ngrxPush"
          [exitEmployees]="exitEmployees$ | ngrxPush"
          [exitEmployeesLoading]="exitEmployeesLoading$ | ngrxPush"
          [entryEmployees]="entryEmployees$ | ngrxPush"
          [entryEmployeesLoading]="entryEmployeesLoading$ | ngrxPush"
          [leaversListDialogMetaHeadings]="
            leaversListDialogMetaHeadings$ | ngrxPush
          "
          [newJoinersListDialogMetaHeadings]="
            newJoinersListDialogMetaHeadings$ | ngrxPush
          "
          [totalEmployeesCount]="totalEmployeesCount$ | ngrxPush"
          [dimensionHint]="dimensionHint$ | ngrxPush"
          (loadExitEmployees)="triggerLoadExitEmployees()"
          (loadEntryEmployees)="triggerLoadEntryEmployees()"
        >
        </ia-entries-exits>
      </div>
    </div>
    <div
      class="w-full flex flex-col lg:flex-col gap-4 lg:col-span-3 xl:col-span-1 row-span-3 md:row-span-1 lg:row-span-2 xl:row-span-1"
    >
      <div class="w-full p-4 shadow">
        <ia-open-positions
          [available]="areOpenApplicationsAvailable$ | ngrxPush"
          [openApplicationsCount]="openApplicationsCount$ | ngrxPush"
          [openApplicationsCountLoading]="
            openApplicationsCountLoading$ | ngrxPush
          "
          [openApplications]="openApplications$ | ngrxPush"
          [openApplicationsLoading]="openApplicationsLoading$ | ngrxPush"
          (openApplicationsRequested)="triggerLoadOpenApplications()"
        >
        </ia-open-positions>
      </div>
      <div class="w-full grow p-4 shadow">
        <ia-resignations
          [data]="resignedEmployees$ | ngrxPush"
          [syncOn]="resignedEmployeesSyncOn$ | ngrxPush"
          [loading]="resignedEmployeesLoading$ | ngrxPush"
          [totalCount]="resignedEmployeesCount$ | ngrxPush"
        ></ia-resignations>
      </div>
    </div>
    <div class="bg-surface-legacy p-4 shadow col-span-full">
      <h5>
        {{ t('attritionRateDetails.title') }}
      </h5>
      <ia-overview-chart
        [dataLoading]="attritionRateLoading$ | ngrxPush"
        [data]="attritionData$ | ngrxPush"
        [attritionEmployeesData]="attritionEmployeesData$ | ngrxPush"
        [attritionEmployeesLoading]="attritionEmployeesLoading$ | ngrxPush"
        [filters]="beautifiedFilters$ | ngrxPush"
        (leaversForTimeRangeRequested)="
          triggerAttritionOverTimeEmployees($event)
        "
      >
      </ia-overview-chart>
    </div>
  </div>
</div>
