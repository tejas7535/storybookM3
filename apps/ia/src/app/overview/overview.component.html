<div *transloco="let t; read: 'overview'">
  <div class="bg-surface flex flex-wrap gap-4 p-4 lg:flex-nowrap">
    <div class="flex w-full flex-col p-4 shadow lg:w-[24%]">
      <div class="flex-1">
        <div class="flex h-full flex-col">
          <h5>{{ t('fluctuationRate') }}</h5>
          <div
            class="divide-border grid grid-cols-2 divide-x divide-solid pb-4"
          >
            <div class="mb-4 pl-4">
              <ia-kpi
                [type]="'leavers'"
                [title]="(benchmarkFluctuationKpi$ | ngrxPush)?.name"
                [value]="(benchmarkFluctuationKpi$ | ngrxPush)?.fluctuationRate"
                [showTeamMemberDialog]="false"
                [isLoading]="isBenchmarkFluctuationKpiLoading$ | ngrxPush"
              ></ia-kpi>
            </div>
            <div class="mb-4 pl-4">
              <ia-kpi
                [type]="'leavers'"
                [title]="(dimensionFluctuationKpi$ | ngrxPush)?.name"
                [value]="(dimensionFluctuationKpi$ | ngrxPush)?.fluctuationRate"
                [employees]="externalExitEmployees$ | ngrxPush"
                [employeesLoading]="exitEmployeesLoading$ | ngrxPush"
                [employeeListDialogMetaHeadings]="
                  totalFluctuationListDialogMetaHeadings$ | ngrxPush
                "
                [employeesCount]="
                  (dimensionFluctuationKpi$ | ngrxPush)?.realTotalLeaversCount
                "
                [showTooltip]="true"
                [isLoading]="isDimensionFluctuationKpiLoading$ | ngrxPush"
                [excludedColumns]="['from', 'to']"
                (openTeamMembers)="triggerLoadExitEmployees()"
              ></ia-kpi>
            </div>
          </div>
          <div class="grow">
            <ia-line-chart
              [config]="fluctuationRatesChartConfig | ngrxPush"
              [isDataLoading]="isFluctuationChartLoading$ | ngrxPush"
              [title]="t('fluctuationChartTitle')"
              [series]="fluctuationChartData$ | ngrxPush"
              [benchmarkSeries]="benchmarkfluctuationChartData$ | ngrxPush"
            ></ia-line-chart>
          </div>
        </div>
      </div>
    </div>
    <div class="flex w-full flex-col p-4 shadow lg:w-[24%]">
      <div class="flex-1">
        <div class="flex h-full flex-col">
          <h5>{{ t('unforcedFluctuationRate') }}</h5>
          <div
            class="divide-border grid grid-cols-2 divide-x divide-solid pb-4"
          >
            <div class="mb-4 pl-4">
              <ia-kpi
                [type]="'leavers'"
                [title]="(benchmarkFluctuationKpi$ | ngrxPush)?.name"
                [value]="
                  (benchmarkFluctuationKpi$ | ngrxPush)?.unforcedFluctuationRate
                "
                [showTeamMemberDialog]="false"
                [isLoading]="isBenchmarkFluctuationKpiLoading$ | ngrxPush"
              ></ia-kpi>
            </div>
            <div class="mb-4 pl-4">
              <ia-kpi
                [type]="'leavers'"
                [title]="(dimensionFluctuationKpi$ | ngrxPush)?.name"
                [value]="
                  (dimensionFluctuationKpi$ | ngrxPush)?.unforcedFluctuationRate
                "
                [employees]="externalUnforcedExitEmployees$ | ngrxPush"
                [employeesLoading]="exitEmployeesLoading$ | ngrxPush"
                [employeeListDialogMetaHeadings]="
                  unforcedFluctuationListDialogMetaHeadings$ | ngrxPush
                "
                [employeesCount]="
                  (dimensionFluctuationKpi$ | ngrxPush)
                    ?.realUnforcedLeaversCount
                "
                [showTooltip]="true"
                [isLoading]="isDimensionFluctuationKpiLoading$ | ngrxPush"
                [excludedColumns]="['reasonForLeaving', 'from', 'to']"
                (openTeamMembers)="triggerLoadExitEmployees()"
              ></ia-kpi>
            </div>
          </div>
          <div class="grow">
            <ia-line-chart
              [config]="unforcedFluctuationRatesChartConfig | ngrxPush"
              [isDataLoading]="isFluctuationChartLoading$ | ngrxPush"
              [title]="t('unforcedFluctuationChartTitle')"
              [series]="unforcedFluctuationChartData$ | ngrxPush"
              [benchmarkSeries]="
                benchmarkUnforcedFluctuationChartData$ | ngrxPush
              "
            ></ia-line-chart>
          </div>
        </div>
      </div>
    </div>
    <div class="flex w-full flex-col p-4 shadow lg:w-[29%] lg:grow">
      <div class="flex-1">
        <ia-entries-exits
          [data]="chartData$ | ngrxPush"
          [isDataLoading]="isLoadingDoughnutsConfig$ | ngrxPush"
          [entriesCount]="entriesCount$ | ngrxPush"
          [exitsCount]="exitsCount$ | ngrxPush"
          [exitEmployees]="exitEmployees$ | ngrxPush"
          [exitEmployeesLoading]="exitEmployeesLoading$ | ngrxPush"
          [entryEmployees]="entryEmployees$ | ngrxPush"
          [entryEmployeesLoading]="entryEmployeesLoading$ | ngrxPush"
          [leaversListDialogMetaHeadings]="
            leaversListDialogMetaHeadings$ | ngrxPush
          "
          [newJoinersListDialogMetaHeadings]="
            newJoinersListDialogMetaHeadings$ | ngrxPush
          "
          [totalEmployeesCount]="totalEmployeesCount$ | ngrxPush"
          [dimensionHint]="dimensionHint$ | ngrxPush"
          (loadExitEmployees)="triggerLoadExitEmployees()"
          (loadEntryEmployees)="triggerLoadEntryEmployees()"
        >
        </ia-entries-exits>
      </div>
    </div>

    <div class="flex w-full grow flex-col lg:w-[23%]">
      <div class="flex flex-1 flex-col gap-4">
        <div class="p-4 shadow">
          <ia-open-positions
            [available]="areOpenApplicationsAvailable$ | ngrxPush"
            [openApplicationsCount]="openApplicationsCount$ | ngrxPush"
            [openApplicationsCountLoading]="
              openApplicationsCountLoading$ | ngrxPush
            "
            [openApplications]="openApplications$ | ngrxPush"
            [openApplicationsLoading]="openApplicationsLoading$ | ngrxPush"
            (openApplicationsRequested)="triggerLoadOpenApplications()"
          >
          </ia-open-positions>
        </div>
        <div class="grow p-4 shadow">
          <ia-resignations
            [data]="resignedEmployees$ | ngrxPush"
            [syncOn]="resignedEmployeesSyncOn$ | ngrxPush"
            [loading]="resignedEmployeesLoading$ | ngrxPush"
            [totalCount]="resignedEmployeesCount$ | ngrxPush"
          ></ia-resignations>
        </div>
      </div>
    </div>
  </div>

  <h5>
    {{ t('attritionRateDetails.title') }}
  </h5>
  <div class="bg-surface">
    <ia-overview-chart
      [dataLoading]="attritionRateLoading$ | ngrxPush"
      [data]="attritionData$ | ngrxPush"
      [attritionEmployeesData]="attritionEmployeesData$ | ngrxPush"
      [attritionEmployeesLoading]="attritionEmployeesLoading$ | ngrxPush"
      [filters]="beautifiedFilters$ | ngrxPush"
      (leaversForTimeRangeRequested)="triggerAttritionOverTimeEmployees($event)"
    >
    </ia-overview-chart>
  </div>
</div>
