<div
  class="bg-surface relative flex h-full min-h-[400px] flex-col"
  *ngrxLet="selectedChartType$ as selectedChart"
>
  <div class="flex items-center self-end mt-3 mb-4 px-4 gap-4">
    <div *transloco="let t; read: 'organizationalView.orgChart'">
      <button
        *ngIf="selectedChart === chartType.ORG_CHART"
        mat-stroked-button
        color="primary"
        class="!bg-surface"
        [disabled]="orgChartLoading$ | ngrxPush"
        (click)="exportImg()"
      >
        <mat-icon>download</mat-icon>{{ t('export') }}
      </button>
    </div>
    <ia-toggle-charts
      [chartType]="selectedChart"
      (changed)="chartTypeChanged($event)"
    ></ia-toggle-charts>
  </div>
  <div class="grow">
    <ia-org-chart
      *ngIf="selectedChart === chartType.ORG_CHART"
      [orgChartData]="orgChart$ | ngrxPush"
      [timeRange]="selectedTimeRange$ | ngrxPush"
      [isLoading]="isLoadingOrgChart$ | ngrxPush"
      [selectedNodeEmployees]="orgChartEmployees$ | ngrxPush"
      [selectedNodeEmployeesLoading]="orgChartEmployeesLoading$ | ngrxPush"
      (showOrgChartEmployees)="loadOrgChartEmployees($event)"
      (showParent)="loadParent($event)"
      (loadChildAttritionOverTime)="loadChildAttritionOverTime($event)"
    ></ia-org-chart>
    <ia-world-map
      *ngIf="selectedChart === chartType.WORLD_MAP"
      [data]="worldMap$ | ngrxPush"
      [regions]="regions$ | ngrxPush"
      [selectedTimeRange]="(selectedTimeRange$ | ngrxPush).value"
      [isLoading]="isLoadingWorldMap$ | ngrxPush"
      (loadRegionMeta)="loadRegionMeta($event)"
      (loadCountryMeta)="loadCountryMeta($event)"
    ></ia-world-map>
  </div>

  <!-- TODO: add again once heat feature is activated -->
  <!-- <div class="absolute right-1 bottom-1 flex flex-col">
    <ia-chart-legend
      [items]="chartLegendItems"
      [title]="'organizationalView.worldMap.chartLegend.title'"
    ></ia-chart-legend>
  </div> -->
</div>
