<div class="m-10 overflow-hidden p-4 sm:mx-auto sm:max-w-lg">
  <mat-card class="hardness-converter-card mx-auto">
    <mac-breadcrumbs [breadcrumbs]="breadcrumbs$ | ngrxPush"></mac-breadcrumbs>
    <mat-card-title class="mx-4">Hardness Converter</mat-card-title>
    <div
      class="absolute z-10 flex h-full w-full justify-center overflow-hidden bg-surface opacity-70 duration-300 ease-in-out"
      [ngClass]="{ hidden: unitList.length !== 0 }"
    >
      <mat-spinner></mat-spinner>
    </div>
    <mat-card-content>
      <div class="px-4 pb-4">
        <form [formGroup]="hardness">
          <div class="justify-between gap-4 md:flex md:w-full">
            <mat-form-field class="w-full">
              <mat-label>Value</mat-label>
              <input
                formControlName="value"
                matInput
                type="number"
                [step]="step"
                (keyup)="handleKeyInput($event.key, $event.target.value)"
                (change)="convertValue($event.target.value)"
              />
            </mat-form-field>
            <mat-form-field appearance="fill" class="w-full">
              <mat-label>From</mat-label>
              <mat-select
                formControlName="unit"
                (selectionChange)="convertValue($event.value)"
              >
                <mat-select-trigger
                  >{{ hardness.controls.unit.value
                  }}<ng-container
                    *ngIf="hardness.controls.unit.value === 'MPa'"
                  >
                    <span matTooltip="Ultimate Tensile Strength"> (UTS) </span>
                  </ng-container></mat-select-trigger
                >
                <mat-option
                  *ngFor="let unit of unitList; trackBy: trackByFn"
                  [value]="unit"
                  >{{ unit }}
                  <ng-container *ngIf="unit === 'MPa'"> (UTS)</ng-container>
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </form>
        <p class="text-center" [@inOutAnimation] *ngIf="results$ | ngrxPush">
          Converted after ISO 18265 - A.1
        </p>
        <div
          class="flex flex-wrap justify-between"
          [@inOutAnimation]
          *ngIf="results$ | ngrxPush"
        >
          <div
            class="absolute z-10 flex h-full w-full justify-center overflow-hidden bg-surface opacity-70 duration-300 ease-in-out"
            [ngClass]="{ hidden: (resultsUpToDate$ | ngrxPush) }"
          >
            <mat-spinner></mat-spinner>
          </div>
          <div
            *ngFor="let result of results$ | ngrxPush; trackBy: trackByFn"
            class="my-2 flex w-full justify-center px-2 md:w-1/2"
          >
            <mat-card class="result-card w-full justify-center">
              <span
                class="flex min-h-[43px] w-4/5 items-center justify-center text-body-1 font-semibold"
                [ngClass]="{ 'capitalize text-warning': result.warning }"
              >
                {{ getValue(result) }}</span
              >
              <span
                class="flex h-full w-1/5 items-center justify-center rounded-r-md bg-primary text-white"
                *ngIf="result.unit !== 'MPa'; else withTooltip"
                >{{ result.unit }}</span
              >
              <ng-template #withTooltip>
                <span
                  class="flex h-full w-1/5 items-center justify-center rounded-r-md bg-primary text-white"
                  matTooltip="Ultimate Tensile Strength"
                  >{{ result.unit }}</span
                >
              </ng-template>
            </mat-card>
          </div>
        </div>
        <mat-error
          *ngIf="error"
          [@inOutAnimation]
          class="hardness-error h-12 items-center justify-center"
          >{{ error }}</mat-error
        >
      </div>
    </mat-card-content>
  </mat-card>
  <div
    class="m-2 flex flex-row justify-center align-middle text-caption text-medium-emphasis"
  >
    Values calculated with Backend v.{{ version }}
  </div>
</div>
