<mat-card
  appearance="outlined"
  class="h-full w-full border !p-0 !shadow-none overflow-hidden"
  [ngClass]="{ 'border-border': !highlighted, '!border-primary': highlighted }"
  *transloco="let t; read: 'overview.overviewCard'"
>
  <div class="flex h-full flex-col">
    <div
      class="flex h-48 w-full flex-col items-center justify-center"
      (mouseenter)="hovered$.next(true)"
      (mouseleave)="hovered$.next(false)"
      (click)="onCardClick()"
      [routerLink]="!external && link ? link : undefined"
    >
      @if (!noAccess) {
        @if (!disableImageHoverEffect) {
          <a
            [target]="external && link ? '_blank' : ''"
            [href]="link"
            [ngClass]="{ 'cursor-pointer': link }"
            (click)="!external ? $event.preventDefault() : undefined"
          >
            <div class="h-full w-full">
              <ng-container>
                <div class="h-full w-full overflow-hidden">
                  @if (!inverted) {
                    <img
                      [src]="image"
                      class="min-h-full min-w-full object-cover object-center"
                    />
                  } @else {
                    <div
                      class="flex h-full w-full flex-col items-center justify-center"
                    >
                      <mat-icon
                        [svgIcon]="icon"
                        class="!block !h-24 !w-24 text-link"
                      ></mat-icon>
                    </div>
                  }
                </div>
              </ng-container>
              @if (hovered$ | ngrxPush) {
                <ng-container #currentlyHovered>
                  @if (!inverted) {
                    <div
                      class="absolute top-0 bottom-32 left-0 right-0 flex flex-col items-center justify-center gap-4 rounded-t-sm bg-[rgb(0,0,0,0.5)] p-12"
                    >
                      <mat-icon
                        [svgIcon]="icon"
                        class="!h-12 !w-12 text-h1-mobile text-white-high-emphasis"
                        [inline]="false"
                      ></mat-icon>
                      @if (!external) {
                        <div
                          class="text-center text-caption text-white-high-emphasis"
                        >
                          {{ t('openApplication') }}
                        </div>
                      } @else {
                        <div
                          class="text-center text-caption text-white-high-emphasis"
                        >
                          {{ t('openApplicationInNewWindow') }}
                        </div>
                      }
                    </div>
                  } @else {
                    <div
                      class="absolute top-0 bottom-32 left-0 right-0 overflow-hidden"
                    >
                      <img
                        [src]="image"
                        class="min-w-full min-h-full object-fit object-cover"
                      />
                    </div>
                    <div
                      class="absolute top-0 bottom-32 left-0 right-0 flex flex-col items-center justify-center gap-4 rounded-t-sm bg-[rgb(0,0,0,0.5)] p-12"
                    >
                      <mat-icon
                        [svgIcon]="icon"
                        class="!h-24 !w-24 text-white-high-emphasis"
                      ></mat-icon>
                      @if (!external) {
                        <div
                          class="absolute bottom-6 text-center text-caption text-white-high-emphasis"
                        >
                          {{ t('openApplication') }}
                        </div>
                      } @else {
                        <div
                          class="absolute bottom-6 text-center text-caption text-white-high-emphasis"
                        >
                          {{ t('openApplicationInNewTab') }}
                        </div>
                      }
                    </div>
                  }
                </ng-container>
              }
            </div>
          </a>
        } @else {
          @if (!inverted) {
            <div class="h-full w-full">
              <img [src]="image" class="max-h-full max-w-full" />
            </div>
          } @else {
            <div
              class="flex h-full w-full flex-col items-center justify-center"
            >
              <mat-icon
                [svgIcon]="icon"
                class="!block !h-24 !w-24 text-link"
              ></mat-icon>
            </div>
          }
        }
      } @else {
        <div
          class="flex h-full w-full flex-col items-center justify-center gap-4 rounded-t-sm bg-[rgb(0,0,0,0.2)]"
        >
          <mat-icon class="text-white-high-emphasis">lock</mat-icon>
          <div class="text-caption text-white-high-emphasis">
            {{ t('noAccessText') }}
          </div>
          @if (requestAccessLink) {
            @if (requestAccessExternal) {
              <a
                class="text-caption text-high-emphasis-dark-bg hover:underline cursor-pointer"
                [href]="requestAccessLink"
                [fragment]="requestAccessLink"
                target="_blank"
              >
                {{ t('requestAccessText')
                }}<mat-icon
                  class="text-high-emphasis-dark-bg !h-5 !w-4 !text-[16px] !align-middle ml-2"
                  >open_in_new</mat-icon
                >
              </a>
            } @else {
              <a
                class="text-caption text-high-emphasis-dark-bg hover:underline cursor-pointer"
                [routerLink]="learnMoreLink"
                [fragment]="requestAccessLink"
                (click)="$event.stopPropagation()"
              >
                {{ t('requestAccessText')
                }}<mat-icon
                  class="text-high-emphasis-dark-bg !h-5 !w-4 !text-[16px] !align-middle ml-2"
                  >open_in_new</mat-icon
                >
              </a>
            }
          }
        </div>
      }
    </div>
    <div class="flex h-32 w-full flex-col items-start justify-start p-4">
      @if (translationKey) {
        <div
          class="line-clamp-1 overflow-hidden text-subtitle-2 text-high-emphasis"
        >
          {{ t(translationKey + '.title') }}
        </div>
      } @else {
        <div
          class="line-clamp-1 overflow-hidden text-subtitle-2 text-high-emphasis"
        >
          {{ title }}
        </div>
      }
      <div class="h-10 flex-1">
        @if (translationKey) {
          <div class="line-clamp-2 text-body-2 text-medium-emphasis">
            {{ t(translationKey + '.description') }}
          </div>
        } @else {
          <div class="line-clamp-2 text-body-2 text-medium-emphasis">
            {{ description }}
          </div>
        }
      </div>
      <div class="flex flex-col items-start justify-end">
        @if (learnMoreLink) {
          @if (!learnMoreExternal) {
            <div
              class="mt-2 cursor-pointer text-caption text-link hover:underline"
              [routerLink]="learnMoreLink"
              (click)="onLearnMoreClick()"
            >
              {{ t('learnMore') }}
            </div>
          } @else {
            <a
              target="_blank"
              [href]="learnMoreLink"
              (click)="onLearnMoreClick()"
            >
              <div
                class="mt-2 cursor-pointer text-caption text-link hover:underline"
              >
                {{ t('learnMore') }}
              </div>
            </a>
          }
        }
      </div>
    </div>
  </div>
</mat-card>
