<ng-container *transloco="let t; read: 'calculationResult'">
  <div
    class="flex flex-shrink-0 flex-col items-center justify-between md:justify-center disabled-border border-border md:border-0 md:w-auto py-2 md:h-auto h-full disabled-bg-surface md:bg-transparent rounded-lg"
    [ngClass]="styleClass"
    *ngIf="_item"
  >
    <div class="flex flex-shrink-0 flex-row items-center justify-center px-2">
      <mat-icon
        color="primary"
        [svgIcon]="_item.svgIcon"
        class="mr-1 flex-shrink-0"
      >
        {{ _item.icon }}
      </mat-icon>
      <div
        class="text-caption text-medium-emphasis inline-flex flex-shrink-0 font-medium"
      >
        {{ t(_item.title) }}
        <ea-info-button
          class="ml-1"
          *ngIf="_item.titleTooltip"
          [inline]="true"
          [tooltip]="t(_item.titleTooltip)"
        ></ea-info-button>
      </div>
    </div>

    <div class="flex flex-row">
      <ng-container *ngFor="let value of _item.values; let last = last">
        <div
          class="flex flex-col md:py-2 px-4"
          [class.items-center]="isSingleItem"
        >
          <div
            class="text-caption text-medium-emphasis mb-2"
            [class.text-center]="isSingleItem"
          >
            {{ value.title && t(value.title) }}
            <ea-info-button
              class="inline-flex align-bottom"
              *ngIf="value.titleTooltip"
              [inline]="true"
              [tooltip]="t(value.titleTooltip)"
            ></ea-info-button>
          </div>

          <div
            class="flex flex-row items-end justify-start"
            *ngIf="!value.isLoading; else loading"
          >
            <ng-container
              *ngIf="
                !value.calculationError && !value.calculationWarning;
                else errorOrWarning
              "
            >
              <div class="text-body-2 text-high-emphasis">
                {{ (value.value | meaningfulRound) || '-' }}
              </div>
              <div
                *ngIf="value.unit"
                class="text-body-2 text-high-emphasis pl-1"
              >
                {{ value.unit }}
              </div>
            </ng-container>

            <ng-template #errorOrWarning>
              <ng-container
                *ngIf="value.calculationError; else warning"
                [ngTemplateOutlet]="error"
              >
              </ng-container>
            </ng-template>

            <ng-template #error>
              <div
                class="flex flex-shrink-0 flex-grow"
                [matTooltip]="value.calculationError"
              >
                <mat-icon color="error" class="!text-body-2 mx-auto"
                  >warning</mat-icon
                >
              </div>
            </ng-template>

            <ng-template #warning>
              <div class="flex items-center">
                <mat-icon class="mr-2 align-middle flex-shrink-0 text-icon-info"
                  >info_outline
                </mat-icon>
                <div
                  class="text-caption text-medium-emphasis md:max-w-[12rem] md:text-left text-center"
                >
                  {{ t(value.calculationWarning) }}
                </div>
              </div>
            </ng-template>
          </div>
        </div>
        <mat-divider [vertical]="true" *ngIf="!last"></mat-divider>
      </ng-container>
    </div>
  </div>
</ng-container>

<ng-template #loading>
  <div class="flex items-center justify-center">
    <mat-spinner diameter="16"></mat-spinner>
  </div>
</ng-template>
