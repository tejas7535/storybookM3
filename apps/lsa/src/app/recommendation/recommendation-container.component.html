<ng-container *transloco="let t">
  <lsa-stepper (selectionChange)="selectionChanged($event)">
    <ng-container *ngrxLet="selectedStep$ as currentStep">
      <ng-container *ngFor="let page of pages; let index = index">
        <cdk-step
          lsaStep
          matStepContent
          [label]="t('pages.' + page.name + '.title')"
          [completed]="page.completed"
        >
          <div class="md:px-8 px-2 pt-8">
            <ng-container [ngSwitch]="index">
              <ng-container *ngSwitchCase="0">
                <lsa-lubrication-points
                  [lubricationPointsForm]="lubricationPointsForm"
                ></lsa-lubrication-points>
              </ng-container>
              <ng-container *ngSwitchCase="1">
                <lsa-lubricant
                  [lubricantForm]="lubricantForm"
                  [greases]="greases$ | ngrxPush"
                ></lsa-lubricant>
              </ng-container>
              <ng-container *ngSwitchCase="2">
                <lsa-application
                  *ngIf="index === currentStep"
                  [applicationForm]="applicationForm"
                ></lsa-application>
              </ng-container>
              <ng-container *ngSwitchCase="3">
                <ng-container *ngrxLet="recommendation$ as recommendation">
                  <lsa-result
                    [recommendationResult]="recommendation"
                  ></lsa-result>
                </ng-container>
                <div class="flex flex-row gap-10 justify-around max-w-full">
                  <div class="flex flex-col">
                    <span>Greases:</span>
                    <pre>{{ greases$ | ngrxPush | json }}</pre>
                  </div>
                  <div class="flex flex-col">
                    <span>Form:</span>
                    <pre>{{ form.getRawValue() | json }}</pre>
                    <span>Valid: {{ form.valid }}</span>
                  </div>
                  <div class="flex flex-col">
                    <span>Result:</span>
                    <pre>{{ recommendation$ | ngrxPush | json }}</pre>
                  </div>
                </div>
              </ng-container>
            </ng-container>
          </div>
        </cdk-step>
      </ng-container>
    </ng-container>
  </lsa-stepper>
</ng-container>
<!-- <pre>{{ form.value | json }}</pre> -->
