<ng-container *ngrxLet="selectedBearing$; let selectedBearing">
  <div
    *transloco="let t; read: 'bearing.bearingSelection.quickSelection'"
    class="relative"
  >
    <div class="flex flex-row space-x-4">
      <schaeffler-search
        appearance="outline"
        [placeholder]="t('searchPlaceholder')"
        [stringOptions]="bearingResultList$ | ngrxPush"
        [initialValue]="
          selectedBearing
            ? { id: selectedBearing, title: selectedBearing }
            : undefined
        "
        [noResultsText]="t('noResults')"
        [loading]="bearingSelectionLoading$ | ngrxPush"
        (searchUpdated)="onSearchUpdated($event)"
        (optionSelected)="onOptionSelected($event)"
        class="flex-grow flex-1"
      >
        <div loadingContent class="relative h-16">
          <ng-container *ngTemplateOutlet="loadingTemplate"></ng-container>
        </div>
        <ng-template #customOptions let-option="option">
          @if (option.data.available) {
            <mat-option [innerHTML]="option.title" />
          } @else {
            <div
              class="flex flex-col md:flex-row py-1 justify-between min-w-full expert-highlight"
            >
              <span [innerHTML]="option.title"></span>
              @if (!(partnerVersion$ | ngrxPush)) {
                <a
                  [href]="
                    transloco.translate('homepage.cards.contact.externalLink')
                  "
                  target="_blank"
                  class="text-link font-medium flex flex-row items-center ml-auto mr-0"
                >
                  <mat-icon class="!mr-2 !text-[16px] !w-4 !h-4"
                    >open_in_new</mat-icon
                  >
                  <span class="hover:underline">{{ t('contact') }}</span>
                </a>
              }
            </div>
          }
        </ng-template>
      </schaeffler-search>
      @if (showDmcFeature) {
        @if (dmcSupported$ | async) {
          <div class="mb-6 flex items-center">
            <a [routerLink]="['/scan']">
              <img src="/assets/images/scan/dmc-code.svg" alt="DMC scan icon" />
            </a>
          </div>
        }
      }
    </div>
    <div class="text-center md:text-right">
      @if (showSelectButton) {
        <button
          mat-flat-button
          color="primary"
          class="w-full md:w-auto"
          (click)="onBearingSelectionButtonClick(selectedBearing)"
          [disabled]="(modelCreationLoading$ | ngrxPush) || !selectedBearing"
        >
          {{ t('selectButton') }}
        </button>
      } @else {
        <ga-advanced-bearing-button></ga-advanced-bearing-button>
      }
    </div>
    @if (modelCreationLoading$ | ngrxPush) {
      <ng-container *ngTemplateOutlet="loadingTemplate"></ng-container>
    }
  </div>
  <ng-template #loadingTemplate>
    <div
      class="absolute top-0 left-0 flex h-full w-full items-center justify-center rounded border border-[white] bg-surface-legacy"
    >
      <mat-spinner diameter="20"></mat-spinner>
    </div>
  </ng-template>
</ng-container>
