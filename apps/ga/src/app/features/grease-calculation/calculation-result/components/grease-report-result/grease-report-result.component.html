<ng-container *ngIf="greaseResult">
  <div
    *transloco="let t; read: 'calculationResult'"
    class="overflow-hidden border-y-[1.5px] border-border lg:rounded lg:border-x-[1.5px]"
  >
    <div class="p-3">
      <div class="flex items-start justify-between">
        <div class="flex flex-col">
          <div class="flex-1 font-medium">
            {{ greaseResult.mainTitle }}
          </div>
          <div
            class="text-caption text-medium-emphasis"
            [innerHTML]="
              greaseResult.isPreferred
                ? t('previouslySelected', {
                    type: greaseResult.mainTitle,
                    grease: preferredGreaseResult.text
                  })
                : showSubtitle()
            "
          ></div>
        </div>

        <!-- Chip if grease in general is not suited -->
        <div
          *ngIf="!greaseResult.isSufficient"
          class="relative ml-3 inline-block"
        >
          <div
            class="ml-3 inline-block cursor-pointer rounded-full bg-orange px-3 py-[1px] text-caption text-high-emphasis-dark-bg"
            matTooltip="{{ t('insufficientGreaseResultTooltip') }}"
            matTooltipPosition="below"
            matTooltipClass="!max-w-[400px]"
            #insufficientTooltip="matTooltip"
            (click)="insufficientTooltip.toggle()"
          >
            {{ t('insufficientGreaseResultHint') }}
          </div>
        </div>

        <!-- Chip for preselection -->
        <div
          *ngIf="
            greaseResult.isSufficient &&
            preferredGreaseResult &&
            (greaseResult.isPreferred || isAlternative())
          "
          class="ml-3 inline-block rounded-full bg-background-dark px-3 py-[1px] text-caption text-medium-emphasis"
          [ngClass]="{
            'cursor-pointer border !border-primary !bg-[#EDF7F1]':
              !greaseResult.isPreferred
          }"
          [matTooltipDisabled]="greaseResult.isPreferred"
          matTooltip="{{ t('preferredGreaseHintAlternativeTooltip') }}"
          matTooltipPosition="below"
          matTooltipClass="!max-w-[400px]"
          #alternativeTooltip="matTooltip"
          (click)="alternativeTooltip.toggle()"
        >
          {{
            t(
              greaseResult.isPreferred
                ? 'preferredGreaseHintSelected'
                : 'preferredGreaseHintAlternative'
            )
          }}
        </div>

        <!-- Chip for CONCEPT1 -->
        <!-- <div
          *ngIf="
            automaticLubrication &&
            ((greaseResult.isSufficient && preferredGreaseResult) ||
              (greaseResult.isSufficient && !preferredGreaseResult))
          "
          class="ml-3 inline-block rounded-full px-3 py-[1px] text-caption text-high-emphasis-dark-bg"
          [ngClass]="{
            '!bg-primary': isSuited(),
            '!bg-orange': isUnSuited(),
            '!bg-background-dark !text-medium-emphasis':
              !isSuited() && !isUnSuited()
          }"
        >
          {{ t('concept1settings.' + getLabel()) }}
        </div> -->
      </div>
    </div>
    <div
      class="overflow-hidden transition-[max-height] duration-300 ease-in-out"
      [ngClass]="{
        'max-h-[2000px]': showAllValues,
        'max-h-[600px]': !showAllValues
      }"
    >
      <schaeffler-label-value
        *ngIf="!showConcept1Details; else concept1Details"
        [labelValues]="labelValues | automaticLubrication: automaticLubrication"
        [labelMaxWidth]="labelWidth"
      >
        <ng-template #custom let-row="row" let-settings="data">
          <div *ngIf="row === concept1">
            <ga-grease-report-concept1
              [settings]="settings"
              (showDetails)="toggleShowConcept1Details()"
            ></ga-grease-report-concept1>
          </div>
        </ng-template>
      </schaeffler-label-value>
    </div>
    <ng-template #concept1Details>
      <ga-grease-report-concept1-detail
        [title]="greaseResult.mainTitle"
        [settings]="getSettings(labelValues)"
        (hideDetails)="toggleShowConcept1Details()"
      ></ga-grease-report-concept1-detail>
    </ng-template>
    <div *ngIf="!showConcept1Details" class="p-3">
      <button
        class="w-full"
        mat-stroked-button
        color="primary"
        (click)="toggleShowValues()"
      >
        <mat-icon
          class="transition-all duration-300 ease-out"
          [ngClass]="{ 'rotate-180': showAllValues }"
          >expand_more</mat-icon
        >
        {{ t(showAllValues ? 'hideValues' : 'allValues') }}
      </button>
    </div>
    <div
      *ngIf="
        !showConcept1Details &&
        greaseResult.isSufficient &&
        greaseResult.subTitle
      "
      class="px-3 pb-3"
    >
      <a
        mat-raised-button
        class="w-full"
        color="primary"
        [attr.href]="getShopUrl()"
        target="_blank"
        (click)="trackGreaseSelection()"
      >
        <mat-icon>water_drop_outline</mat-icon>
        {{ getLinkText() }}
      </a>
    </div>
  </div>
</ng-container>
