<ng-container *transloco="let t; read: 'recommendationPopup'">
  <div
    class="border-border border-b flex flex-row justify-between items-center px-4 py-4"
  >
    <h3 class="text-[20px] leading-snug">{{ t('modalTitle') }}</h3>
    <button
      mat-icon-button
      (click)="backClick()"
      color="primary"
      class="block md:hidden"
    >
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <div
    class="flex flex-col-reverse md:flex-row px-4 py-[10px] md:gap-8 overflow-y-auto"
  >
    <div
      class="marketing-group overflow-x-auto md:w-3/5 py-4 md:py-8 bg-surface md:bg-[#f6f7f8] rounded-md"
    >
      <!-- Mobile table -->
      <table
        class="medias-comparison-mobile md:hidden"
        *transloco="let t; read: 'recommendationPopup.mediasComparison'"
      >
        <colgroup>
          <col />
          <col class="min-w-[40px]" />
          <col class="min-w-[65px]" />
        </colgroup>
        <thead>
          <tr class="border-b-2 border-[#ced5da]">
            <th>
              <span class="sr-only">Feature description</span>
            </th>
            <th class="px-2 pb-2">
              <img
                class="h-6"
                src="https://cdn.schaeffler-ecommerce.com/frontend/logos/medias.svg"
                alt="medias free logo"
              />
            </th>
            <th class="px-2 pb-2">
              <img
                class="h-6"
                src="https://cdn.schaeffler-ecommerce.com/frontend/logos/medias_plus.svg"
                alt="medias plus logo"
              />
            </th>
          </tr>
        </thead>
        <tbody>
          @for (entry of mediasTable; track entry.title) {
            <tr class="even:bg-[#f6f7f8] border-b border-[#ced5da]">
              <td class="text-[13px] text-[#666666] font-bold py-2 pl-2">
                {{ t(entry.title) }}
              </td>
              <td class="text-center py-1">
                @if (typeof(entry.free) === 'string') {
                  <span class="text-[13px]">{{ entry.free }}</span>
                } @else {
                  <div class="flex justify-center items-center">
                    <ng-container
                      *ngTemplateOutlet="
                        boxIcon;
                        context: { icon: entry.free | optionalIcon }
                      "
                    ></ng-container>
                  </div>
                }
              </td>
              <td class="text-center py-1">
                @if (typeof(entry.plus) === 'string') {
                  <span class="text-[13px]">{{ entry.free }}</span>
                } @else {
                  <div class="flex items-center justify-center">
                    <ng-container
                      *ngTemplateOutlet="
                        boxIcon;
                        context: { icon: entry.plus | optionalIcon }
                      "
                    ></ng-container>
                  </div>
                }
              </td>
            </tr>
          }
        </tbody>
      </table>
      <!-- Desktop comparison grid -->
      <div
        class="grid-comparison-table mr-4 md:grid hidden"
        *transloco="let t; read: 'recommendationPopup.mediasComparison'"
      >
        <div
          class="free-box block col-start-2 row-span-full my-7 border-[#ced5da] border border-r-0 bg-surface"
        ></div>

        <div
          class="plus-box block col-start-3 row-span-full border-[#ced5da] border bg-surface"
        ></div>

        <div
          style="grid-area: 1/2"
          class="flex text-center flex-col justify-end mx-3 pb-4 border-b-[#ced5da] border-b aspect-auto"
        >
          <img
            class="h-6"
            src="https://cdn.schaeffler-ecommerce.com/frontend/logos/medias.svg"
            alt="medias free logo"
          />
        </div>
        <div
          style="grid-area: 1/3"
          class="flex text-center flex-col justify-end mx-3 pb-4 border-b-[#ced5da] border-b"
        >
          <img
            class="h-6"
            src="https://cdn.schaeffler-ecommerce.com/frontend/logos/medias_plus.svg"
            alt="medias plus logo"
          />
        </div>

        @for (entry of mediasTable; track entry.title; let index = $index) {
          <div
            [style]="makeCellStyle('title', index + 2)"
            class="text-high-emphasis font-bold text-right mr-2 text-[13px]"
          >
            <span>{{ t(entry.title) }}</span>
          </div>

          <div
            [style]="makeCellStyle('free', index + 2)"
            class="text-center flex justify-center items-center"
          >
            @if (typeof(entry.free) === 'string') {
              <span class="text-[13px]">{{ entry.free }}</span>
            } @else {
              <ng-container
                *ngTemplateOutlet="
                  boxIcon;
                  context: { icon: entry.free | optionalIcon }
                "
              ></ng-container>
            }
          </div>
          <div
            [style]="makeCellStyle('plus', index + 2)"
            class="text flex justify-center items-center"
          >
            @if (typeof(entry.plus) === 'string') {
              <span class="text-[13px]">{{ entry.free }}</span>
            } @else {
              <ng-container
                *ngTemplateOutlet="
                  boxIcon;
                  context: { icon: entry.plus | optionalIcon }
                "
              ></ng-container>
            }
          </div>
        }
      </div>
    </div>

    <div class="marketing-text md:w-2/5 py-3 flex items-center">
      <div class="flex flex-col mb-3">
        <div
          class="flex flex-col md:flex-row items-center justify-center md:justify-start mb-2"
        >
          <ga-app-logo [showText]="false" />
          <h2 class="text-[18px] md:text-[22px] leading-snug">
            {{ t('modalHeading') }}
          </h2>
        </div>
        <p>{{ t('modalText') }}</p>
        <a
          [href]="utmSignupUrl$ | ngrxPush"
          target="_blank"
          mat-raised-button
          color="primary"
          class="mt-4 max-w-fit inline-flex"
        >
          {{ t('registrationCta') }}
        </a>
      </div>
    </div>
  </div>
  <div class="flex flex-row border-t border-border py-2 pt-2 px-4">
    <div class="ml-auto mr-0 flex flex-row items-center space-x-3 text-[13px]">
      {{ t('loginQuestion') }}
      <a
        [href]="utmSignupUrl$ | ngrxPush"
        target="_blank"
        mat-button
        color="primary"
        class="ml-4"
        >{{ t('loginText') }}</a
      >
    </div>
  </div>
</ng-container>

<ng-template #boxIcon let-icon="icon">
  @if (icon === 'checkmark') {
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="28"
      height="28"
      viewBox="0 0 28 28"
      version="1.1"
    >
      <g id="surface1">
        <path
          d="M 14 28 C 21.730469 28 28 21.730469 28 14 C 28 6.269531 21.730469 0 14 0 C 6.269531 0 0 6.269531 0 14 C 0 21.730469 6.269531 28 14 28 Z M 14 28 "
          style="
            stroke: none;
            fill-rule: evenodd;
            fill: rgb(0, 137, 61);
            fill-opacity: 1;
          "
        ></path>
        <path
          d="M 10.9375 18.003906 L 6.957031 13.996094 L 5.601562 15.351562 L 10.9375 20.71875 L 22.398438 9.195312 L 21.054688 7.839844 Z M 10.9375 18.003906 "
          style="
            stroke: none;
            fill-rule: evenodd;
            fill: rgb(255, 255, 255);
            fill-opacity: 1;
          "
        ></path>
      </g>
    </svg>
  } @else {
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="28"
      height="28"
      viewBox="0 0 28 28"
      version="1.1"
    >
      <g id="surface1">
        <path
          d="M 14 28 C 21.730469 28 28 21.730469 28 14 C 28 6.269531 21.730469 0 14 0 C 6.269531 0 0 6.269531 0 14 C 0 21.730469 6.269531 28 14 28 Z M 14 28 "
          style="
            stroke: none;
            fill-rule: evenodd;
            fill: rgb(193, 192, 192);
            fill-opacity: 1;
          "
        ></path>
        <path
          d="M 21 8.410156 L 19.589844 7 L 14 12.589844 L 8.410156 7 L 7 8.410156 L 12.589844 14 L 7 19.589844 L 8.410156 21 L 14 15.410156 L 19.589844 21 L 21 19.589844 L 15.410156 14 Z M 21 8.410156 "
          style="
            stroke: none;
            fill-rule: evenodd;
            fill: rgb(255, 255, 255);
            fill-opacity: 1;
          "
        ></path>
      </g>
    </svg>
  }
</ng-template>
