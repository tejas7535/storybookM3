<ng-container *ngIf="!(loading$ | ngrxPush); else loading">
  <mat-card
    *transloco="let t; read: 'conditionMonitoring.edmMonitor'"
    class="h-full overflow-y-scroll"
  >
    <div class="flex flex-col h-full">
      <div class="flex justify-between">
        <mat-card-header class="w-full">
          <mat-card-title>
            <div class="inline-flex items-center justify-between w-full">
              <div class="inline-flex items-center">
                <mat-icon svgIcon="icon-vibration"></mat-icon>
                <span>{{ t('title') }}</span>
              </div>
              <div class="inline-flex items-center">
                <goldwind-sensor
                  [type]="type"
                  [sensor]="sensor"
                  (sensorToggle)="switchSensor($event)"
                  class="mr-2"
                ></goldwind-sensor>
                <button
                  mat-icon-button
                  class="flex hover:bg-hoverOverlay transition-colors"
                >
                  <mat-icon (click)="openMoreInfo()" class="text-mediumEmphasis"
                    >more_vert</mat-icon
                  >
                </button>
              </div>
            </div>
          </mat-card-title>
          <mat-card-subtitle *transloco="let t; read: 'bearing'">
            <div class="flex flex-col">
              <span *ngIf="interval$ | ngrxPush as interval; else notime">
                {{ interval.startDate * 1000 | date }} -
                {{ interval.endDate * 1000 | date }}</span
              >
              <ng-template #notime
                ><span>t('noTimestampAvailable')</span></ng-template
              >
              <span> {{ t('updateFrequency') }}: {{ refresh / 60 }}m</span>
            </div>
          </mat-card-subtitle>
        </mat-card-header>
      </div>
      <mat-card-content class="h-full">
        <div class="flex flex-col h-full">
          <ng-container *ngrxLet="edmGraphData$ as graphData">
            <goldwind-empty-graph
              [graphData]="graphData"
            ></goldwind-empty-graph>
          </ng-container>
          <div
            echarts
            class="h-full"
            [options]="chartOptions"
            [merge]="edmGraphData$ | ngrxPush"
          ></div>
        </div>
      </mat-card-content>
    </div>
  </mat-card>
</ng-container>

<ng-template #loading>
  <mat-card class="full-height-card placeholder-item"></mat-card>
</ng-template>
