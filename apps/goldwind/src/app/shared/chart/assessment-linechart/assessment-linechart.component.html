<div class="flex h-full max-h-full flex-col gap-4 sm:flex sm:flex-row">
  <mat-card
    class="max-h-full w-full overflow-y-auto sm:w-3/5 sm:min-w-[60%] md:w-2/5 md:min-w-[40%]"
  >
    <div class="flex h-full max-h-full flex-col">
      <mat-card-header>
        <mat-card-title>
          <div class="flex items-center">
            <mat-icon class="mr-2">date_range</mat-icon>
            <span>Date Picker</span>
          </div>
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <goldwind-date-range
          [interval]="interval$ | ngrxPush"
          (rangeChange)="setInterval($event)"
        ></goldwind-date-range>
        <ng-container *ngrxLet="graphData$ as graphData">
          <goldwind-empty-graph [graphData]="graphData"></goldwind-empty-graph>
        </ng-container>
        <div class="flex h-14 max-h-full flex-col">
          <h6
            class="text-2xl mb-4 mt-8 font-medium leading-6 text-high-emphasis"
          >
            {{ translate('linechart.pleaseSelectTrendsToShow') }}
          </h6>
          <mat-tree
            #tree
            [dataSource]="dataSource"
            [treeControl]="treeControl"
            class="h-full max-h-full"
            [formGroup]="displayForm"
          >
            <mat-tree-node *matTreeNodeDef="let node" matTreeNodePadding>
              <label class="inline-flex items-center">
                <input
                  [formControlName]="node.formControl"
                  type="checkbox"
                  [ngStyle]="{ color: node.color }"
                  class="form-checkbox bg-[#414546] text-body-1"
                  #nodeCbPa
                />
                <span
                  class="ml-2"
                  [class.text-high-emphasis]="nodeCbPa.checked"
                  [class.text-medium-emphasis]="!nodeCbPa.checked"
                  >{{ translate(this.translateKey + '.' + node.label) }}</span
                >
              </label>
            </mat-tree-node>
            <mat-tree-node
              *matTreeNodeDef="let node; when: hasChild"
              matTreeNodePadding
            >
              <input
                [checked]="!getIndeterminate(node.name)"
                (change)="this.updateChildForms(node, nodeCb.checked)"
                #nodeCb
                type="checkbox"
                class="!bg-toastBg form-checkbox text-body-1"
              />
              <button
                mat-icon-button
                matTreeNodeToggle
                [attr.aria-label]="'Toggle ' + node.name"
              >
                <mat-icon class="mat-icon-rtl-mirror ml-2 text-body-2">
                  {{
                    treeControl.isExpanded(node)
                      ? 'expand_more'
                      : 'chevron_right'
                  }}
                </mat-icon>
              </button>
              <span
                class="ml-2 text-body-2"
                [class.text-high-emphasis]="nodeCb.checked"
                [class.text-medium-emphasis]="!nodeCb.checked"
              >
                {{ translate(this.translateKey + '.' + node.name) }}</span
              >
              <!-- <mat-checkbox
              [color]="'secondary'"
              [formControl]="node.formControl"
              [indeterminate]="getIndeterminate(node.name)"
            >
              <button
                mat-icon-button
                matTreeNodeToggle
                [attr.aria-label]="'Toggle ' + node.name"
              >

              </button>
              {{ translate(this.translateKey + '.' + node.name) }}
            </mat-checkbox> -->
            </mat-tree-node>
          </mat-tree>
        </div>
      </mat-card-content>
    </div>
  </mat-card>

  <mat-card class="h-full w-full lg:w-full">
    <mat-card-header class="w-full">
      <mat-card-title class="w-full">
        <div class="flex w-full justify-between">
          <div class="inline-flex items-center">
            <mat-icon class="mr-2">timeline</mat-icon>
            <span> {{ translate(this.translateKey + '.' + 'title') }}</span>
          </div>
          <div class="flex">
            <button
              class="flex items-center text-button uppercase text-link"
              (click)="downloadChartContent()"
            >
              <mat-icon class="mr-2 text-subtitle-1">download</mat-icon>
              <span>Download</span>
            </button>
            <button mat-icon-button (click)="openMoreInfo()">
              <mat-icon class="text-medium-emphasis">more_vert</mat-icon>
            </button>
          </div>
        </div>
      </mat-card-title>
      <mat-card-subtitle>
        <div id="interval" *ngIf="this.interval$">
          <span *ngrxLet="this.interval$ as interval">
            {{ interval.startDate * 1000 | date: 'EE, MMM d, y, h:mm:ss a' }}
            - {{ interval.endDate * 1000 | date: 'EE, MMM d, y, h:mm:ss a' }}
          </span>
        </div>
      </mat-card-subtitle>
    </mat-card-header>
    <mat-card-content class="space-between flex h-full flex-col items-center">
      <ng-container *ngIf="graphData$ | ngrxPush as graphData; else loading">
        <div
          class="h-5/6 w-full"
          echarts
          [options]="chartOptions"
          [merge]="graphData"
          (chartDataZoom)="onChartZoom($event)"
          (chartInit)="onInit($event)"
        ></div>
      </ng-container>
      <ng-template #loading>
        <div class="placeholder-item flex"></div>
      </ng-template>
    </mat-card-content>
  </mat-card>
</div>
