<mat-form-field
  appearance="fill"
  *transloco="let t; read: 'search.referenceTypesFilters'"
  class="custom-mat-form-field"
>
  <mat-label>{{ t(filterName) }}</mat-label>
  <mat-select
    [formControl]="form"
    multiple
    disableOptionCentering
    panelClass="custom-select-panel"
    (openedChange)="updateFiltersOnDropdownClose($event)"
  >
    <mat-select-trigger>
      {{ form.value | multiSelectValue }}
    </mat-select-trigger>
    <mat-form-field class="search-field" floatLabel="never">
      <input
        matInput
        placeholder="{{ t('searchPlaceholder') }}"
        [formControl]="searchForm"
      />
      <button
        mat-button
        *ngIf="searchForm.value && !autocompleteLoading"
        matSuffix
        mat-icon-button
        aria-label="Clear"
        (click)="resetSearchField()"
      >
        <mat-icon>close</mat-icon>
      </button>
      <mat-spinner
        *ngIf="autocompleteLoading"
        class="autocomplete-loading"
        matSuffix
        [diameter]="18"
      ></mat-spinner>
    </mat-form-field>

    <mat-option
      *ngIf="filterOptions.length === 0"
      class="dummy-option"
    ></mat-option>
    <mat-checkbox
      *ngIf="filterOptions.length > 0"
      class="select-all"
      [color]="'primary'"
      [checked]="selectAllChecked"
      [indeterminate]="selectAllIndeterminate"
      [disabled]="filterOptions.length === 0"
      (change)="selectAllChange($event.checked)"
    >
      {{ t('selectAll') }}
      <span class="label">{{ form.value.length }} selected</span>
    </mat-checkbox>

    <div class="divider" *ngIf="filterOptions.length > 0">
      <hr />
    </div>

    <div class="custom-options-container">
      <mat-option
        (onSelectionChange)="selectionChange($event)"
        *ngFor="let option of filterOptions; trackBy: trackByFn"
        [value]="option"
        [matTooltip]="option.value"
        matTooltipShowDelay="1000"
        >{{ option.value }}</mat-option
      >
    </div>
  </mat-select>
</mat-form-field>
