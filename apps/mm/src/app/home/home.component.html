<ng-container *transloco="let t">
  <mat-horizontal-stepper
    schaefflerSeperatedSteps
    (selectionChange)="selectStep($event)"
    [selectedIndex]="currentStep()"
    [ngClass]="{
      '[&_mat-step-header:first-of-type]:pointer-events-none':
        isAppDeliveryEmbedded(),
    }"
    linear="true"
    class="p-1"
    #stepper
  >
    <ng-container>
      @for (step of steps(); track step.name; let index = $index) {
        <mat-step
          state="number"
          [completed]="step.complete"
          [editable]="!isAppDeliveryEmbedded() || index !== BEARING_STEP"
          optional="false"
          ><ng-template matStepLabel>{{ t(step.text) }}</ng-template>
          <div class="pt-2 sm:pt-4">
            @switch (index) {
              @case (BEARING_STEP) {
                @if (!isAppDeliveryEmbedded()) {
                  <h5>{{ t(step.text) }}</h5>
                  <div class="mt-8 mb-4 max-w-sm sm:mb-8">
                    <mm-bearing-search
                      (bearing)="selectBearing($event)"
                      [selectedBearing]="selectedBearingOption()"
                    ></mm-bearing-search>
                  </div>
                  <mm-qualtrics-info-banner
                    class="block my-3"
                  ></mm-qualtrics-info-banner>
                }
              }
              @case (BEARING_SEAT_STEP) {
                @if (index === currentStep()) {
                  <h5>{{ t(step.text) }}</h5>
                  <mm-bearing-seat-step
                    [bearingSeats]="bearingSeats()"
                    [bearing]="selectedBearing()"
                    (selectedOption)="selectBearingSeatOption($event)"
                  ></mm-bearing-seat-step>
                  <mm-qualtrics-info-banner
                    class="block my-3"
                  ></mm-qualtrics-info-banner>
                }
              }
              @case (MEASURING_MOUNTING_STEP) {
                @if (index === currentStep()) {
                  <h5>{{ t(step.text) }}</h5>
                  <mm-measuring-and-mounting-step
                    [measurementMethods]="measurementMethods()"
                    [mountingMethods]="mountingMethods()"
                    [bearing]="selectedBearing()"
                    [isLoading]="isLoading()"
                    [mountingMethodSelectionLabel]="
                      t('dialog.selectMountingLabel')
                    "
                    [measuringMethodLabel]="t('dialog.measuringMethod')"
                    (selectedOption)="selectMountingMethod($event)"
                    (selectedMeasurementMethod)="
                      selectMeasurementMethod($event)
                    "
                  ></mm-measuring-and-mounting-step>
                  <mm-qualtrics-info-banner
                    class="block my-3"
                  ></mm-qualtrics-info-banner>
                }
              }
              @case (CALCULATION_OPTIONS_STEP) {
                @if (index === currentStep()) {
                  @if (isAxialBearing()) {
                    <mm-calculation-options-step
                      [preflightData]="preflightData()"
                    >
                    </mm-calculation-options-step>
                    <mm-qualtrics-info-banner
                      class="block my-3"
                    ></mm-qualtrics-info-banner>
                  } @else {
                    <!-- This is for radial bearings at index, which is RADIAL_BEARINGS_RESULT_STEP -->
                    <mm-report-result-page> </mm-report-result-page>
                  }
                }
              }
              @case (AXIAL_BEARINGS_RESULT_STEP) {
                <mm-report-result-page> </mm-report-result-page>
              }
              @default {
                <p>Default content</p>
              }
            }

            @if (isAppDeliveryEmbedded()) {
              <mm-app-store-buttons
                class="flex justify-center mb-8"
                [title]="t('shared.appStoreButtonsTitle')"
              ></mm-app-store-buttons>
            }
          </div>
        </mat-step>
      }
    </ng-container>
    <ng-template matStepperIcon="edit" let-index="index">
      {{ index + 1 }}
    </ng-template>
  </mat-horizontal-stepper>
</ng-container>
