<div class="flex flex-row">
  <mat-form-field
    matAutocompleteOrigin
    #origin="matAutocompleteOrigin"
    class="w-full px-4 border-primary"
    (keydown.Tab)="$event.preventDefault()"
  >
    <input
      *ngIf="!attachToCustomElement; else attachedPanelInput"
      type="text"
      matInput
      [matAutocomplete]="auto"
      [formControl]="searchControl"
      (keydown.Tab)="
        $event.preventDefault();
        $event.stopPropagation();
        openAutocompletePanel()
      "
      #searchInput
    />
    <ng-template #attachedPanelInput>
      <input
        type="text"
        matInput
        [matAutocomplete]="auto"
        [matAutocompleteConnectedTo]="_autocompletePanelElement"
        [formControl]="searchControl"
        (keydown.Tab)="
          $event.preventDefault();
          $event.stopPropagation();
          openAutocompletePanel()
        "
        #searchInput
      />
    </ng-template>
    <mat-hint *ngIf="hint">{{ hint }}</mat-hint>
  </mat-form-field>
  <div class="my-auto mx-4">
    <button
      mat-button
      *ngIf="searchControl.value; else searchIcon"
      mat-icon-button
      type="button"
      (click)="$event.stopPropagation(); $event.preventDefault(); focusInput()"
    >
      <mat-icon class="text-light">cancel</mat-icon>
    </button>
    <ng-template #searchIcon>
      <mat-icon class="text-light">search</mat-icon>
    </ng-template>
  </div>
</div>
<mat-autocomplete #auto="matAutocomplete" class="custom-scrollbar">
  <mat-option
    *ngFor="let option of filteredOptions | async"
    [value]="option.value"
    (click)="select(option)"
    (onSelectionChange)="onOptionSelect($event)"
    [ngClass]="{ 'active-option': option === selectedItem }"
  >
    {{ option.value }}
  </mat-option>
</mat-autocomplete>
